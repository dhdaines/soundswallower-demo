(()=>{var e={179:(e,t,s)=>{"use strict";s.r(t)},985:(e,t,s)=>{"use strict";s.r(t)},146:(e,t,s)=>{const r=s(544);e.exports=class extends r{constructor(e){super(),this._messageId=1,this._messages=new Map,this._worker=e,this._worker.onmessage=this._onMessage.bind(this),this._id=Math.ceil(1e7*Math.random())}terminate(){this._worker.terminate()}isFree(){return 0===this._messages.size}jobsLength(){return this._messages.size}exec(e,t=null,s=[],r){return new Promise(((i,n)=>{const o=this._messageId++;this._messages.set(o,[i,n,r]),this._worker.postMessage([o,t,e],s||[])}))}postMessage(e=null,t=[],s){return new Promise(((r,i)=>{const n=this._messageId++;this._messages.set(n,[r,i,s]),this._worker.postMessage([n,e],t||[])}))}emit(e,...t){this._worker.postMessage({eventName:e,args:t})}_onMessage(e){if(!Array.isArray(e.data)&&e.data.eventName)return super.emit(e.data.eventName,...e.data.args);const[t,...s]=e.data;if(1===t)this._onEvent(...s);else{if(0!==t)throw new Error(`Wrong message type '${t}'`);this._onResult(...s)}}_onResult(e,t,s){const[r,i]=this._messages.get(e);return this._messages.delete(e),1===t?r(s):i(s)}_onEvent(e,t,s){const[,,r]=this._messages.get(e);r&&r(t,s)}}},544:e=>{e.exports=class{constructor(){Object.defineProperty(this,"__listeners",{value:{},enumerable:!1,writable:!1})}emit(e,...t){if(!this.__listeners[e])return this;for(const s of this.__listeners[e])s(...t);return this}once(e,t){const s=(...r)=>{this.off(e,s),t(...r)};return this.on(e,s)}on(e,t){return this.__listeners[e]||(this.__listeners[e]=[]),this.__listeners[e].push(t),this}off(e,t){return this.__listeners[e]=t?this.__listeners[e].filter((e=>e!==t)):[],this}}},478:(e,t,s)=>{"use strict";e.exports=s.p+"model/cities.dict"},348:(e,t,s)=>{"use strict";e.exports=s.p+"model/cities.gram"},696:(e,t,s)=>{"use strict";e.exports=s.p+"model/numbers.gram"},978:(e,t,s)=>{"use strict";e.exports=s.p+"model/pizza.gram"},738:(e,t,s)=>{"use strict";e.exports=s.p+"36c78cdefe17257e774a.js"}},t={};function s(r){var i=t[r];if(void 0!==i)return i.exports;var n=t[r]={exports:{}};return e[r](n,n.exports,s),n.exports}s.m=e,s.u=e=>e+".js",s.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e;s.g.importScripts&&(e=s.g.location+"");var t=s.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var r=t.getElementsByTagName("script");r.length&&(e=r[r.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),s.p=e})(),s.b=document.baseURI||self.location.href,(()=>{"use strict";s(179),s(985);const e=s(146);var t,r,i,n,o,a={Pizza:s(978),Numbers:s(696),Cities:s(348)},c={Cities:s(478)},d=!1;function u(e){t&&(t.innerHTML=e)}function l(e){document.getElementById("current-status").innerHTML=e}function p(e){document.getElementById("recording-indicator").innerHTML=e?"&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;":"",d=e}window.onload=async function(){const g=document.getElementById("startBtn"),m=document.getElementById("stopBtn");g.disabled=!0,m.disabled=!0;var h=document.getElementById("grammars");for(const e in a){var w=document.createElement("option");w.innerHTML=e,h.appendChild(w)}var f=document.getElementById("jsgf");async function y(e){let t=a[e],s=await fetch(t);if(s.ok){let e=await s.text();f.value=e}else l("Failed to fetch "+t+" :"+s.statusText)}await y(h.options[h.selectedIndex].innerText),t=document.getElementById("output"),l("Initializing web audio, waiting for approval to access the microphone");try{const e=window.AudioContext||window.webkitAudioContext;r=new e,await r.suspend();const t=await navigator.mediaDevices.getUserMedia({audio:!0});n=r.createMediaStreamSource(t);const i=new URL(s(738),s.b);await r.audioWorklet.addModule(i),o=new AudioWorkletNode(r,"soundswallower-processor"),n.connect(o).connect(r.destination),l("Audio recorder ready")}catch(e){l("Error initializing Web Audio browser: "+e.message)}l("Initializing speech recognizer");try{i=new e(new Worker(new URL(s.p+s.u(4),s.b))),await i.exec("initialize",{loglevel:"DEBUG",samprate:r.sampleRate}),await async function(){for(const e in c)await i.exec("loadDict",c[e])}()}catch(e){l("Error initializing speech recognizer: "+e.message)}async function _(){var e;d&&(e=!0,await i.exec("stop"),p(!1));try{await i.exec("setJSGF",f.value),l("Updated grammar")}catch(e){l("Failed to set grammar: "+e.message)}if(e){try{await i.exec("start")}catch(e){l("Error starting recognition: "+e.message)}p(!0)}}await _(),l("Speech recognizer ready"),h.addEventListener("change",(async function(){var e=this.options[this.selectedIndex].innerText;await y(e),await _()}));let b=null;f.addEventListener("input",(()=>{clearTimeout(b),b=setTimeout(_,1e3)})),o.port.onmessage=async function(e){if(!d)return!0;if("ERROR"==e.data)return l("AudioWorkletNode got disconnected somehow?!?!?!"),o=new AudioWorkletNode(r,"soundswallower-processor"),n.connect(o).connect(r.destination),!0;try{await i.exec("process",e.data,[e.data.buffer]);let t=await i.exec("getHyp");void 0!==t&&u(t)}catch(e){l("Error processing data: "+e.message)}return!0},g.onclick=async function(){d&&await i.exec("stop");try{await i.exec("start")}catch(e){l("Error starting recognition: "+e.message)}return await r.resume(),p(!0),!0},m.onclick=async function(){if(await r.suspend(),d){try{const{hyp:e,hypseg:t}=await i.exec("stop");void 0!==e&&u(e),p(!1)}catch(e){l("Error stopping recognition: "+e.message)}return!0}},g.disabled=!1,m.disabled=!1}})()})();