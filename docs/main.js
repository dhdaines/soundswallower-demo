(()=>{var t={179:(t,e,n)=>{"use strict";n.r(e)},985:(t,e,n)=>{"use strict";n.r(e)},62:t=>{t.exports=class{constructor(t){for(var e in this.options={fftSize:512,bufferLen:512,voice_stop:function(){},voice_start:function(){},smoothingTimeConstant:.99,energy_offset:1e-8,energy_threshold_ratio_pos:2,energy_threshold_ratio_neg:.5,energy_integration:1,filter:[{f:200,v:0},{f:2e3,v:1}],source:null,context:null},t)t.hasOwnProperty(e)&&(this.options[e]=t[e]);if(!this.options.source)throw new Error("The options must specify a MediaStreamAudioSourceNode.");this.options.context=this.options.source.context,this.hertzPerBin=this.options.context.sampleRate/this.options.fftSize,this.iterationFrequency=this.options.context.sampleRate/this.options.bufferLen,this.iterationPeriod=1/this.iterationFrequency,console.log("Vad | sampleRate: "+this.options.context.sampleRate+" | hertzPerBin: "+this.hertzPerBin+" | iterationFrequency: "+this.iterationFrequency+" | iterationPeriod: "+this.iterationPeriod),this.setFilter(this.options.filter),this.ready={},this.vadState=!1,this.energy_offset=this.options.energy_offset,this.energy_threshold_pos=this.energy_offset*this.options.energy_threshold_ratio_pos,this.energy_threshold_neg=this.energy_offset*this.options.energy_threshold_ratio_neg,this.voiceTrend=0,this.voiceTrendMax=10,this.voiceTrendMin=-10,this.voiceTrendStart=5,this.voiceTrendEnd=-5,this.analyser=this.options.context.createAnalyser(),this.analyser.smoothingTimeConstant=this.options.smoothingTimeConstant,this.analyser.fftSize=this.options.fftSize,this.floatFrequencyData=new Float32Array(this.analyser.frequencyBinCount),this.floatFrequencyDataLinear=new Float32Array(this.floatFrequencyData.length),this.options.source.connect(this.analyser),this.scriptProcessorNode=this.options.context.createScriptProcessor(this.options.bufferLen,1,1),this.scriptProcessorNode.connect(this.options.context.destination);var n=this;this.scriptProcessorNode.onaudioprocess=function(t){n.analyser.getFloatFrequencyData(n.floatFrequencyData),n.update(),n.monitor()},this.options.source.connect(this.scriptProcessorNode),this.logging=!1,this.log_i=0,this.log_limit=100}setFilter(t){this.filter=[];for(var e=0,n=this.options.fftSize/2;e<n;e++){this.filter[e]=0;for(var i=0,r=t.length;i<r;i++)if(e*this.hertzPerBin<t[i].f){this.filter[e]=t[i].v;break}}}triggerLog(t){this.logging=!0,this.log_i=0,this.log_limit="number"==typeof t?t:this.log_limit}log(t){this.logging&&this.log_i<this.log_limit?(this.log_i++,console.log(t)):this.logging=!1}update(){for(var t=this.floatFrequencyData,e=0,n=t.length;e<n;e++)this.floatFrequencyDataLinear[e]=Math.pow(10,t[e]/10);this.ready={}}getEnergy(){if(this.ready.energy)return this.energy;for(var t=0,e=this.floatFrequencyDataLinear,n=0,i=e.length;n<i;n++)t+=this.filter[n]*e[n]*e[n];return this.energy=t,this.ready.energy=!0,t}monitor(){var t=this.getEnergy(),e=t-this.energy_offset;e>this.energy_threshold_pos?this.voiceTrend=this.voiceTrend+1>this.voiceTrendMax?this.voiceTrendMax:this.voiceTrend+1:e<-this.energy_threshold_neg?this.voiceTrend=this.voiceTrend-1<this.voiceTrendMin?this.voiceTrendMin:this.voiceTrend-1:this.voiceTrend>0?this.voiceTrend--:this.voiceTrend<0&&this.voiceTrend++;var n=!1,i=!1;this.voiceTrend>this.voiceTrendStart?n=!0:this.voiceTrend<this.voiceTrendEnd&&(i=!0);var r=e*this.iterationPeriod*this.options.energy_integration;return this.energy_offset+=r>0||!i?r:10*r,this.energy_offset=this.energy_offset<0?0:this.energy_offset,this.energy_threshold_pos=this.energy_offset*this.options.energy_threshold_ratio_pos,this.energy_threshold_neg=this.energy_offset*this.options.energy_threshold_ratio_neg,n&&!this.vadState&&(this.vadState=!0,this.options.voice_start()),i&&this.vadState&&(this.vadState=!1,this.options.voice_stop()),this.log("e: "+t+" | e_of: "+this.energy_offset+" | e+_th: "+this.energy_threshold_pos+" | e-_th: "+this.energy_threshold_neg+" | signal: "+e+" | int: "+r+" | voiceTrend: "+this.voiceTrend+" | start: "+n+" | end: "+i),e}}},925:t=>{t.exports=__dirname},890:(t,e,n)=>{var i,r=(i="undefined"!=typeof document&&document.currentScript?document.currentScript.src:void 0,"undefined"!=typeof __filename&&(i=i||__filename),function(t){var e,r;(t=void 0!==(t=t||{})?t:{}).ready=new Promise((function(t,n){e=t,r=n}));var s,o,a,_,l,c,u=Object.assign({},t),f=[],p="./this.program",d=(t,e)=>{throw e},h="object"==typeof window,m="function"==typeof importScripts,g="";"object"==typeof process&&"object"==typeof process.versions&&"string"==typeof process.versions.node?(g=m?n(395).dirname(g)+"/":__dirname+"/",c=()=>{l||(_=n(762),l=n(395))},s=function(t,e){return c(),t=l.normalize(t),_.readFileSync(t,e?void 0:"utf8")},a=t=>{var e=s(t,!0);return e.buffer||(e=new Uint8Array(e)),e},o=(t,e,n)=>{c(),t=l.normalize(t),_.readFile(t,(function(t,i){t?n(t):e(i.buffer)}))},process.argv.length>1&&(p=process.argv[1].replace(/\\/g,"/")),f=process.argv.slice(2),process.on("uncaughtException",(function(t){if(!(t instanceof ut))throw t})),process.on("unhandledRejection",(function(t){throw t})),d=(t,e)=>{if(W())throw process.exitCode=t,e;var n;(n=e)instanceof ut||v("exiting due to exception: "+n),process.exit(t)},t.inspect=function(){return"[Emscripten Module object]"}):(h||m)&&(m?g=self.location.href:"undefined"!=typeof document&&document.currentScript&&(g=document.currentScript.src),i&&(g=i),g=0!==g.indexOf("blob:")?g.substr(0,g.replace(/[?#].*/,"").lastIndexOf("/")+1):"",s=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.send(null),e.responseText},m&&(a=t=>{var e=new XMLHttpRequest;return e.open("GET",t,!1),e.responseType="arraybuffer",e.send(null),new Uint8Array(e.response)}),o=(t,e,n)=>{var i=new XMLHttpRequest;i.open("GET",t,!0),i.responseType="arraybuffer",i.onload=()=>{200==i.status||0==i.status&&i.response?e(i.response):n()},i.onerror=n,i.send(null)});var y,w=t.print||console.log.bind(console),v=t.printErr||console.warn.bind(console);Object.assign(t,u),u=null,t.arguments&&(f=t.arguments),t.thisProgram&&(p=t.thisProgram),t.quit&&(d=t.quit),t.wasmBinary&&(y=t.wasmBinary);var b,E=t.noExitRuntime||!0;function x(t,e="i8",n){switch("*"===e.charAt(e.length-1)&&(e="i32"),e){case"i1":case"i8":return S[t>>0];case"i16":return R[t>>1];case"i32":case"i64":return j[t>>2];case"float":return k[t>>2];case"double":return Number(M[t>>3]);default:Y("invalid type for getValue: "+e)}return null}"object"!=typeof WebAssembly&&Y("no native wasm support detected");var T=!1;function A(e,n,i,r,s){var o={string:function(t){var e=0;if(null!=t&&0!==t){var n=1+(t.length<<2);!function(t,e,n){C(t,z,e,n)}(t,e=ct(n),n)}return e},array:function(t){var e=ct(t.length);return L(t,e),e}},a=function(e){return t["_"+e]}(e),_=[],l=0;if(r)for(var c=0;c<r.length;c++){var u=o[i[c]];u?(0===l&&(l=_t()),_[c]=u(r[c])):_[c]=r[c]}var f=a.apply(null,_);return function(t){return 0!==l&&lt(l),function(t){return"string"===n?I(t):"boolean"===n?Boolean(t):t}(t)}(f)}var F,S,z,R,j,k,M,P="undefined"!=typeof TextDecoder?new TextDecoder("utf8"):void 0;function B(t,e,n){for(var i=e+n,r=e;t[r]&&!(r>=i);)++r;if(r-e>16&&t.buffer&&P)return P.decode(t.subarray(e,r));for(var s="";e<r;){var o=t[e++];if(128&o){var a=63&t[e++];if(192!=(224&o)){var _=63&t[e++];if((o=224==(240&o)?(15&o)<<12|a<<6|_:(7&o)<<18|a<<12|_<<6|63&t[e++])<65536)s+=String.fromCharCode(o);else{var l=o-65536;s+=String.fromCharCode(55296|l>>10,56320|1023&l)}}else s+=String.fromCharCode((31&o)<<6|a)}else s+=String.fromCharCode(o)}return s}function I(t,e){return t?B(z,t,e):""}function C(t,e,n,i){if(!(i>0))return 0;for(var r=n,s=n+i-1,o=0;o<t.length;++o){var a=t.charCodeAt(o);if(a>=55296&&a<=57343&&(a=65536+((1023&a)<<10)|1023&t.charCodeAt(++o)),a<=127){if(n>=s)break;e[n++]=a}else if(a<=2047){if(n+1>=s)break;e[n++]=192|a>>6,e[n++]=128|63&a}else if(a<=65535){if(n+2>=s)break;e[n++]=224|a>>12,e[n++]=128|a>>6&63,e[n++]=128|63&a}else{if(n+3>=s)break;e[n++]=240|a>>18,e[n++]=128|a>>12&63,e[n++]=128|a>>6&63,e[n++]=128|63&a}}return e[n]=0,n-r}function D(t){var e=function(t){for(var e=0,n=0;n<t.length;++n){var i=t.charCodeAt(n);i>=55296&&i<=57343&&(i=65536+((1023&i)<<10)|1023&t.charCodeAt(++n)),i<=127?++e:e+=i<=2047?2:i<=65535?3:4}return e}(t)+1,n=ct(e);return C(t,S,n,e),n}function L(t,e){S.set(t,e)}function U(e){F=e,t.HEAP8=S=new Int8Array(e),t.HEAP16=R=new Int16Array(e),t.HEAP32=j=new Int32Array(e),t.HEAPU8=z=new Uint8Array(e),t.HEAPU16=new Uint16Array(e),t.HEAPU32=new Uint32Array(e),t.HEAPF32=k=new Float32Array(e),t.HEAPF64=M=new Float64Array(e)}t.INITIAL_MEMORY;var q,H=[],N=[],O=[];function W(){return E}var G,$,J=0,V=null,X=null;function Y(e){t.onAbort&&t.onAbort(e),v(e="Aborted("+e+")"),T=!0,e+=". Build with -s ASSERTIONS=1 for more info.";var n=new WebAssembly.RuntimeError(e);throw r(n),n}function K(t){return t.startsWith("data:application/octet-stream;base64,")}function Q(t){return t.startsWith("file://")}function Z(t){try{if(t==G&&y)return new Uint8Array(y);if(a)return a(t);throw"both async and sync fetching of the wasm failed"}catch(t){Y(t)}}function tt(e){for(;e.length>0;){var n=e.shift();if("function"!=typeof n){var i=n.func;"number"==typeof i?void 0===n.arg?et(i)():et(i)(n.arg):i(void 0===n.arg?null:n.arg)}else n(t)}}function et(t){return q.get(t)}t.preloadedImages={},t.preloadedAudios={},K(G="soundswallower.wasm")||($=G,G=t.locateFile?t.locateFile($,g):g+$);var nt={buffers:[null,[],[]],printChar:function(t,e){var n=nt.buffers[t];0===e||10===e?((1===t?w:v)(B(n,0)),n.length=0):n.push(e)},varargs:void 0,get:function(){return nt.varargs+=4,j[nt.varargs-4>>2]},getStr:function(t){return I(t)},get64:function(t,e){return t}};function it(t){try{return b.grow(t-F.byteLength+65535>>>16),U(b.buffer),1}catch(t){}}var rt={};function st(){if(!st.strings){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:("object"==typeof navigator&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"};for(var e in rt)void 0===rt[e]?delete t[e]:t[e]=rt[e];var n=[];for(var e in t)n.push(e+"="+t[e]);st.strings=n}return st.strings}var ot,at={d:function(t,e,n){return nt.varargs=n,0},f:function(t,e){},h:function(t,e,n){return nt.varargs=n,0},r:function(t,e,n,i){},e:function(t,e,n,i){nt.varargs=i},s:function(t,e){},i:function(){return Date.now()},k:function(){throw 1/0},n:function(t,e,n,i,r,s,o,a){return-52},o:function(t,e,n,i,r,s){},t:function(){Y("")},m:function(){return 2147483648},l:function(t){var e,n=z.length,i=2147483648;if((t>>>=0)>i)return!1;for(var r=1;r<=4;r*=2){var s=n*(1+.2/r);if(s=Math.min(s,t+100663296),it(Math.min(i,(e=Math.max(t,s))+(65536-e%65536)%65536)))return!0}return!1},p:function(t,e){var n=0;return st().forEach((function(i,r){var s=e+n;j[t+4*r>>2]=s,function(t,e,n){for(var i=0;i<t.length;++i)S[e++>>0]=t.charCodeAt(i);S[e>>0]=0}(i,s),n+=i.length+1})),0},q:function(t,e){var n=st();j[t>>2]=n.length;var i=0;return n.forEach((function(t){i+=t.length+1})),j[e>>2]=i,0},a:function(e){!function(e,n){var i;i=e,W()||(t.onExit&&t.onExit(i),T=!0),d(i,new ut(i))}(e)},b:function(t){return 0},g:function(t,e,n,i){var r=nt.getStreamFromFD(t),s=nt.doReadv(r,e,n);return j[i>>2]=s,0},j:function(t,e,n,i,r){},c:function(t,e,n,i){for(var r=0,s=0;s<n;s++){var o=j[e>>2],a=j[e+4>>2];e+=8;for(var _=0;_<a;_++)nt.printChar(t,z[o+_]);r+=a}return j[i>>2]=r,0}},_t=(function(){var e={a:at};function n(e,n){var i,r=e.exports;t.asm=r,U((b=t.asm.u).buffer),q=t.asm.G,i=t.asm.v,N.unshift(i),function(e){if(J--,t.monitorRunDependencies&&t.monitorRunDependencies(J),0==J&&(null!==V&&(clearInterval(V),V=null),X)){var n=X;X=null,n()}}()}function i(t){n(t.instance)}function s(t){return function(){if(!y&&(h||m)){if("function"==typeof fetch&&!Q(G))return fetch(G,{credentials:"same-origin"}).then((function(t){if(!t.ok)throw"failed to load wasm binary file at '"+G+"'";return t.arrayBuffer()})).catch((function(){return Z(G)}));if(o)return new Promise((function(t,e){o(G,(function(e){t(new Uint8Array(e))}),e)}))}return Promise.resolve().then((function(){return Z(G)}))}().then((function(t){return WebAssembly.instantiate(t,e)})).then((function(t){return t})).then(t,(function(t){v("failed to asynchronously prepare wasm: "+t),Y(t)}))}if(J++,t.monitorRunDependencies&&t.monitorRunDependencies(J),t.instantiateWasm)try{return t.instantiateWasm(e,n)}catch(t){return v("Module.instantiateWasm callback failed with error: "+t),!1}(y||"function"!=typeof WebAssembly.instantiateStreaming||K(G)||Q(G)||"function"!=typeof fetch?s(i):fetch(G,{credentials:"same-origin"}).then((function(t){return WebAssembly.instantiateStreaming(t,e).then(i,(function(t){return v("wasm streaming compile failed: "+t),v("falling back to ArrayBuffer instantiation"),s(i)}))}))).catch(r)}(),t.___wasm_call_ctors=function(){return(t.___wasm_call_ctors=t.asm.v).apply(null,arguments)},t._fsg_set_states=function(){return(t._fsg_set_states=t.asm.w).apply(null,arguments)},t._cmd_ln_hash_iter=function(){return(t._cmd_ln_hash_iter=t.asm.x).apply(null,arguments)},t._hash_iter_key=function(){return(t._hash_iter_key=t.asm.y).apply(null,arguments)},t._set_mdef=function(){return(t._set_mdef=t.asm.z).apply(null,arguments)},t._set_tmat=function(){return(t._set_tmat=t.asm.A).apply(null,arguments)},t._load_gmm=function(){return(t._load_gmm=t.asm.B).apply(null,arguments)},t._ptm_mgau_init_s3file=function(){return(t._ptm_mgau_init_s3file=t.asm.C).apply(null,arguments)},t._s3file_rewind=function(){return(t._s3file_rewind=t.asm.D).apply(null,arguments)},t._s2_semi_mgau_init_s3file=function(){return(t._s2_semi_mgau_init_s3file=t.asm.E).apply(null,arguments)},t._ms_mgau_init_s3file=function(){return(t._ms_mgau_init_s3file=t.asm.F).apply(null,arguments)},t._cmd_ln_str_r=function(){return(t._cmd_ln_str_r=t.asm.H).apply(null,arguments)},t._cmd_ln_float_r=function(){return(t._cmd_ln_float_r=t.asm.I).apply(null,arguments)},t._cmd_ln_int_r=function(){return(t._cmd_ln_int_r=t.asm.J).apply(null,arguments)},t._cmd_ln_retain=function(){return(t._cmd_ln_retain=t.asm.K).apply(null,arguments)},t._logmath_retain=function(){return(t._logmath_retain=t.asm.L).apply(null,arguments)},t._cmd_ln_free_r=function(){return(t._cmd_ln_free_r=t.asm.M).apply(null,arguments)},t._logmath_free=function(){return(t._logmath_free=t.asm.N).apply(null,arguments)},t._s3file_free=function(){return(t._s3file_free=t.asm.O).apply(null,arguments)},t._bin_mdef_read_s3file=function(){return(t._bin_mdef_read_s3file=t.asm.P).apply(null,arguments)},t._malloc=function(){return(t._malloc=t.asm.Q).apply(null,arguments)},t._free=function(){return(t._free=t.asm.R).apply(null,arguments)},t._cmd_ln_parse_r=function(){return(t._cmd_ln_parse_r=t.asm.S).apply(null,arguments)},t._cmd_ln_init=function(){return(t._cmd_ln_init=t.asm.T).apply(null,arguments)},t._cmd_ln_exists_r=function(){return(t._cmd_ln_exists_r=t.asm.U).apply(null,arguments)},t._cmd_ln_type_r=function(){return(t._cmd_ln_type_r=t.asm.V).apply(null,arguments)},t._cmd_ln_set_str_r=function(){return(t._cmd_ln_set_str_r=t.asm.W).apply(null,arguments)},t._cmd_ln_set_int_r=function(){return(t._cmd_ln_set_int_r=t.asm.X).apply(null,arguments)},t._cmd_ln_set_float_r=function(){return(t._cmd_ln_set_float_r=t.asm.Y).apply(null,arguments)},t._fsg_model_trans_add=function(){return(t._fsg_model_trans_add=t.asm.Z).apply(null,arguments)},t._fsg_model_tag_trans_add=function(){return(t._fsg_model_tag_trans_add=t.asm._).apply(null,arguments)},t._fsg_model_null_trans_add=function(){return(t._fsg_model_null_trans_add=t.asm.$).apply(null,arguments)},t._hash_table_iter_next=function(){return(t._hash_table_iter_next=t.asm.aa).apply(null,arguments)},t._fsg_model_word_id=function(){return(t._fsg_model_word_id=t.asm.ba).apply(null,arguments)},t._fsg_model_word_add=function(){return(t._fsg_model_word_add=t.asm.ca).apply(null,arguments)},t._logmath_log=function(){return(t._logmath_log=t.asm.da).apply(null,arguments)},t._fsg_model_init=function(){return(t._fsg_model_init=t.asm.ea).apply(null,arguments)},t._fsg_model_free=function(){return(t._fsg_model_free=t.asm.fa).apply(null,arguments)},t._fsg_model_retain=function(){return(t._fsg_model_retain=t.asm.ga).apply(null,arguments)},t._logmath_exp=function(){return(t._logmath_exp=t.asm.ha).apply(null,arguments)},t._jsgf_grammar_free=function(){return(t._jsgf_grammar_free=t.asm.ia).apply(null,arguments)},t._jsgf_get_rule=function(){return(t._jsgf_get_rule=t.asm.ja).apply(null,arguments)},t._jsgf_get_public_rule=function(){return(t._jsgf_get_public_rule=t.asm.ka).apply(null,arguments)},t._jsgf_build_fsg=function(){return(t._jsgf_build_fsg=t.asm.la).apply(null,arguments)},t._jsgf_parse_string=function(){return(t._jsgf_parse_string=t.asm.ma).apply(null,arguments)},t._logmath_init=function(){return(t._logmath_init=t.asm.na).apply(null,arguments)},t._ps_init_config=function(){return(t._ps_init_config=t.asm.oa).apply(null,arguments)},t._ps_args=function(){return(t._ps_args=t.asm.pa).apply(null,arguments)},t._ps_init_cleanup=function(){return(t._ps_init_cleanup=t.asm.qa).apply(null,arguments)},t._ps_init_fe=function(){return(t._ps_init_fe=t.asm.ra).apply(null,arguments)},t._ps_init_feat_s3file=function(){return(t._ps_init_feat_s3file=t.asm.sa).apply(null,arguments)},t._ps_init_acmod_pre=function(){return(t._ps_init_acmod_pre=t.asm.ta).apply(null,arguments)},t._ps_init_acmod_post=function(){return(t._ps_init_acmod_post=t.asm.ua).apply(null,arguments)},t._ps_init_dict_s3file=function(){return(t._ps_init_dict_s3file=t.asm.va).apply(null,arguments)},t._ps_set_fsg=function(){return(t._ps_set_fsg=t.asm.wa).apply(null,arguments)},t._ps_init_grammar_s3file=function(){return(t._ps_init_grammar_s3file=t.asm.xa).apply(null,arguments)},t._ps_set_jsgf_string=function(){return(t._ps_set_jsgf_string=t.asm.ya).apply(null,arguments)},t._ps_reinit_fe=function(){return(t._ps_reinit_fe=t.asm.za).apply(null,arguments)},t._ps_init=function(){return(t._ps_init=t.asm.Aa).apply(null,arguments)},t._ps_retain=function(){return(t._ps_retain=t.asm.Ba).apply(null,arguments)},t._ps_free=function(){return(t._ps_free=t.asm.Ca).apply(null,arguments)},t._ps_get_config=function(){return(t._ps_get_config=t.asm.Da).apply(null,arguments)},t._ps_get_logmath=function(){return(t._ps_get_logmath=t.asm.Ea).apply(null,arguments)},t._ps_add_word=function(){return(t._ps_add_word=t.asm.Fa).apply(null,arguments)},t._ps_lookup_word=function(){return(t._ps_lookup_word=t.asm.Ga).apply(null,arguments)},t._ps_start_utt=function(){return(t._ps_start_utt=t.asm.Ha).apply(null,arguments)},t._ps_process_float32=function(){return(t._ps_process_float32=t.asm.Ia).apply(null,arguments)},t._ps_end_utt=function(){return(t._ps_end_utt=t.asm.Ja).apply(null,arguments)},t._ps_get_hyp=function(){return(t._ps_get_hyp=t.asm.Ka).apply(null,arguments)},t._ps_seg_iter=function(){return(t._ps_seg_iter=t.asm.La).apply(null,arguments)},t._ps_seg_word=function(){return(t._ps_seg_word=t.asm.Ma).apply(null,arguments)},t._ps_seg_frames=function(){return(t._ps_seg_frames=t.asm.Na).apply(null,arguments)},t._ps_seg_prob=function(){return(t._ps_seg_prob=t.asm.Oa).apply(null,arguments)},t._ps_seg_next=function(){return(t._ps_seg_next=t.asm.Pa).apply(null,arguments)},t._ps_get_prob=function(){return(t._ps_get_prob=t.asm.Qa).apply(null,arguments)},t._ps_seg_free=function(){return(t._ps_seg_free=t.asm.Ra).apply(null,arguments)},t._s3file_init=function(){return(t._s3file_init=t.asm.Sa).apply(null,arguments)},t._tmat_init_s3file=function(){return(t._tmat_init_s3file=t.asm.Ta).apply(null,arguments)},t.stackSave=function(){return(_t=t.stackSave=t.asm.Ua).apply(null,arguments)}),lt=t.stackRestore=function(){return(lt=t.stackRestore=t.asm.Va).apply(null,arguments)},ct=t.stackAlloc=function(){return(ct=t.stackAlloc=t.asm.Wa).apply(null,arguments)};function ut(t){this.name="ExitStatus",this.message="Program terminated with exit("+t+")",this.status=t}function ft(n){function i(){ot||(ot=!0,t.calledRun=!0,T||(tt(N),e(t),t.onRuntimeInitialized&&t.onRuntimeInitialized(),function(){if(t.postRun)for("function"==typeof t.postRun&&(t.postRun=[t.postRun]);t.postRun.length;)e=t.postRun.shift(),O.unshift(e);var e;tt(O)}()))}n=n||f,J>0||(function(){if(t.preRun)for("function"==typeof t.preRun&&(t.preRun=[t.preRun]);t.preRun.length;)e=t.preRun.shift(),H.unshift(e);var e;tt(H)}(),J>0||(t.setStatus?(t.setStatus("Running..."),setTimeout((function(){setTimeout((function(){t.setStatus("")}),1),i()}),1)):i()))}if(X=function t(){ot||ft(),ot||(X=t)},t.run=ft,t.preInit)for("function"==typeof t.preInit&&(t.preInit=[t.preInit]);t.preInit.length>0;)t.preInit.pop()();ft(),void 0===t.defaultModel&&(t.defaultModel="en-us"),void 0===t.modelBase&&(t.modelBase=h?"model/":n(925));class pt{constructor(e){if(this.cmd_ln=t._cmd_ln_parse_r(0,t._ps_args(),0,0,0),void 0===e){if(null===t.defaultModel)return;e={hmm:t.get_model_path(t.defaultModel)}}else null!==t.defaultModel&&("hmm"in e||(e.hmm=t.get_model_path(t.defaultModel)));for(const t in e)this.set(t,e[t])}delete(){this.cmd_ln&&t._cmd_ln_free_r(this.cmd_ln),this.cmd_ln=0}normalize_key(t){if(t.length>0){if("_"==t[0])return t;if("-"==t[0]){const e="_"+t.substr(1);return this.has(e)?e:t}{const e="_"+t;if(this.has(e))return e;const n="-"+t;return this.has(n)?n:t}}return""}normalize_ckey(t){const e=I(t);return 0==e.length?e:"-"==e[0]||"_"==e[0]?e.substr(1):e}set(e,n){const i=D(this.normalize_key(e)),r=t._cmd_ln_type_r(this.cmd_ln,i);if(0==r)throw new ReferenceError("Unknown cmd_ln parameter "+e);if(8&r){const e=D(n);t._cmd_ln_set_str_r(this.cmd_ln,i,e)}else if(4&r)t._cmd_ln_set_float_r(this.cmd_ln,i,n);else{if(!(18&r))return!1;t._cmd_ln_set_int_r(this.cmd_ln,i,n)}return!0}get(e){const n=D(this.normalize_key(e)),i=t._cmd_ln_type_r(this.cmd_ln,n);if(0==i)throw new ReferenceError("Unknown cmd_ln parameter "+e);if(8&i){const e=t._cmd_ln_str_r(this.cmd_ln,n);return 0==e?null:I(e)}if(4&i)return t._cmd_ln_float_r(this.cmd_ln,n);if(2&i)return t._cmd_ln_int_r(this.cmd_ln,n);if(16&i)return Boolean(t._cmd_ln_int_r(this.cmd_ln,n));throw new TypeError("Unsupported type "+i+" for parameter"+e)}model_file_path(t,e){const n=this.get(t);if(null!=n)return n;const i=this.get("hmm");if(null==i)throw new Error("Could not get "+t+" from config or model directory");return i+"/"+e}has(e){const n=D(e);return t._cmd_ln_exists_r(this.cmd_ln,n)}*[Symbol.iterator](){let e=t._cmd_ln_hash_iter(this.cmd_ln);const n=new Set;for(;0!=e;){const i=t._hash_iter_key(e),r=this.normalize_ckey(i);n.has(r)||(n.add(r),e=t._hash_table_iter_next(e),yield r)}}}async function dt(e){let i;if(h){const t=await fetch(e);if(!t.ok)throw new Error("Failed to fetch "+e+" :"+t.statusText);{const e=await t.blob(),n=await e.arrayBuffer();i=new Uint8Array(n)}}else{const t=n(299),r=await t.readFile(e);i=new Uint8Array(r.buffer)}const r=i.length+1,s=t._malloc(r);if(0==s)throw new Error("Failed to allocate "+r+" bytes for "+e);return L(i,s),S[s+r]=0,t._s3file_init(s,r-1)}return t.get_model_path=function(e){return h?t.modelBase+e:n(395).join(t.modelBase,e)},t.Config=pt,t.Decoder=class{constructor(e){if(this.config=e&&"object"==typeof e&&"cmd_ln"in e?e:new t.Config(...arguments),this.initialized=!1,this.ps=t._ps_init(0),0==this.ps)throw new Error("Failed to construct Decoder")}async initialize(e){if(0==this.ps)throw new Error("Decoder was somehow not constructed (ps==0)");void 0!==e&&(this.config&&this.config.delete(),this.config="object"==typeof e&&"cmd_ln"in e?e:new t.Config(...arguments)),await this.init_config(),await this.init_fe(),await this.init_feat(),await this.init_acmod(),await this.load_acmod_files(),await this.init_dict(),await this.init_grammar(),this.initialized=!0}async init_config(){await this.init_featparams();let e=t._ps_init_config(this.ps,this.config.cmd_ln);if(e<0)throw new Error("Failed to initialize basic configuration");if(e=t._ps_init_cleanup(this.ps),e<0)throw new Error("Failed to clean up decoder internals")}async init_featparams(){const t=this.config.model_file_path("featparams","feat.params");for await(const e of async function*(t){let e;if(h){const n=await fetch(t);if(!n.ok)throw new Error("Failed to fetch "+t+" :"+n.statusText);e=await n.text()}else{const i=n(299);e=await i.readFile(t,{encoding:"utf8"})}const i=/^.*$/gm,r=/"([^"]*)"|'([^'])'|(\S+)/g;let s=null;for(const t of e.matchAll(i)){const e=t[0].trim();for(const t of e.matchAll(r)){const e=t[1]??t[2]??t[3];if("#"==e)break;null!==s?(yield[s,e],s=null):s=e}}if(null!==s)throw new Error("Odd number of arguments in "+t)}(t))this.config.has(e[0])&&this.config.set(e[0],e[1])}async init_fe(){if(0==t._ps_init_fe(this.ps))throw new Error("Failed to initialize frontend")}async init_feat(){let e;try{const n=this.config.model_file_path("lda","feature_transform"),i=await dt(n);e=t._ps_init_feat_s3file(this.ps,i)}catch(n){e=t._ps_init_feat_s3file(this.ps,0)}if(0==e)throw new Error("Failed to initialize feature module")}async init_acmod(){if(0==t._ps_init_acmod_pre(this.ps))throw new Error("Failed to initialize acoustic model")}async load_acmod_files(){await this.load_mdef();const e=this.config.model_file_path("tmat","transition_matrices");await this.load_tmat(e);const n=this.config.model_file_path("mean","means"),i=this.config.model_file_path("var","variances"),r=this.config.model_file_path("sendump","sendump"),s=this.config.model_file_path("mixw","mixture_weights");if(await this.load_gmm(n,i,r,s),t._ps_init_acmod_post(this.ps)<0)throw new Error("Failed to initialize acoustic scoring")}async load_mdef(){var e,n;try{e=this.config.model_file_path("mdef","mdef.bin"),n=await dt(e)}catch(t){try{e=this.config.model_file_path("mdef","mdef.txt"),n=await dt(e)}catch(t){e=this.config.model_file_path("mdef","mdef"),n=await dt(e)}}const i=t._bin_mdef_read_s3file(n,0);if(t._s3file_free(n),0==i)throw new Error("Failed to read mdef");t._set_mdef(this.ps,i)}async load_tmat(e){const n=await dt(e),i=t._ps_get_logmath(this.ps),r=this.config.get("tmatfloor"),s=t._tmat_init_s3file(n,i,r);if(t._s3file_free(n),0==s)throw new Error("Failed to read tmat");t._set_tmat(this.ps,s)}async load_gmm(e,n,i,r){const s=await dt(e),o=await dt(n);var a,_;try{a=await dt(i),_=0}catch(t){a=0,_=await dt(r)}if(t._load_gmm(this.ps,s,o,_,a)<0)throw new Error("Failed to load GMM parameters")}async init_dict(){const e=this.config.model_file_path("dict","dict.txt"),n=await dt(e);let i;try{const t=this.config.model_file_path("fdict","noisedict");i=await dt(t)}catch(t){i=0}if(0==t._ps_init_dict_s3file(this.ps,n,i))throw new Error("Failed to initialize dictionaries")}async init_grammar(){let e=0,n=0;const i=this.config.get("jsgf");null!=i&&(n=await dt(i));const r=this.config.get("fsg");if(null!=r&&(e=await dt(r)),(e||n)&&t._ps_init_grammar_s3file(this.ps,e,n)<0)throw new Error("Failed to initialize grammar")}assert_initialized(){if(!this.initialized)throw new Error("Decoder not yet initialized")}async reinitialize_audio(){this.assert_initialized(),t._ps_reinit_fe(this.ps,0)}delete(){this.config&&this.config.delete(),this.ps&&t._ps_free(this.ps),this.ps=0}async start(){if(this.assert_initialized(),t._ps_start_utt(this.ps)<0)throw new Error("Failed to start utterance processing")}async stop(){if(this.assert_initialized(),t._ps_end_utt(this.ps)<0)throw new Error("Failed to stop utterance processing")}async process(e,n=!1,i=!1){this.assert_initialized();const r=e.length*e.BYTES_PER_ELEMENT,s=t._malloc(r);L(new Uint8Array(e.buffer),s);const o=t._ps_process_float32(this.ps,s,r/4,n,i);if(t._free(s),o<0)throw new Error("Utterance processing failed");return o}get_hyp(){return this.assert_initialized(),I(t._ps_get_hyp(this.ps,0))}get_hypseg(){this.assert_initialized();let e=t._ps_seg_iter(this.ps);const n=t._ps_get_config(this.ps),i=t._cmd_ln_int_r(n,D("-frate")),r=[];for(;0!=e;){const n=ct(8);t._ps_seg_frames(e,n,n+4);const s=x(n,"i32"),o=x(n+4,"i32"),a={word:A("ps_seg_word","string",["number"],[e]),start:s/i,end:o/i};r.push(a),e=t._ps_seg_next(e)}return r}lookup_word(e){this.assert_initialized();const n=D(e),i=t._ps_lookup_word(this.ps,n);return 0==i?null:I(i)}async add_word(e,n,i=!0){this.assert_initialized();const r=D(e),s=D(n),o=t._ps_add_word(this.ps,r,s,i);if(o<0)throw new Error("Failed to add word "+e+" with pronunciation "+n+" to the dictionary.");return o}create_fsg(e,n,i,r){this.assert_initialized();const s=t._ps_get_logmath(this.ps),o=t._ps_get_config(this.ps),a=t._cmd_ln_float_r(o,D("-lw"));let _=0;for(const t of r)_=Math.max(_,t.from,t.to);_++;const l=A("fsg_model_init","number",["string","number","number","number"],[e,s,a,_]);t._fsg_set_states(l,n,i);for(const e of r){let n=0;if("prob"in e&&(n=t._logmath_log(s,e.prob)),"word"in e){const i=A("fsg_model_word_add","number",["number","string"],[l,e.word]);if(-1==i)return t._fsg_model_free(l),0;t._fsg_model_trans_add(l,e.from,e.to,n,i)}else t._fsg_model_null_trans_add(l,e.from,e.to,n)}return{fsg:l,delete(){t._fsg_model_free(this.fsg),this.fsg=0}}}parse_jsgf(e,n=null){this.assert_initialized();const i=t._ps_get_logmath(this.ps),r=t._ps_get_config(this.ps),s=t._cmd_ln_float_r(r,D("-lw")),o=D(e),a=t._jsgf_parse_string(o,0);if(0==a)throw new Error("Failed to parse JSGF");let _;if(null!==n){const e=D(n);if(_=t._jsgf_get_rule(a,e),0==_)throw new Error("Failed to find top rule "+n)}else if(_=t._jsgf_get_public_rule(a),0==_)throw new Error("No public rules found in JSGF");const l=t._jsgf_build_fsg(a,_,i,s);return t._jsgf_grammar_free(a),{fsg:l,delete(){t._fsg_model_free(this.fsg),this.fsg=0}}}async set_fsg(e){if(this.assert_initialized(),0!=t._ps_set_fsg(this.ps,"_default",e.fsg))throw new Error("Failed to set FSG in decoder")}},t.ready});t.exports=r},478:(t,e,n)=>{"use strict";t.exports=n.p+"model/cities.dict"},348:(t,e,n)=>{"use strict";t.exports=n.p+"model/cities.gram"},696:(t,e,n)=>{"use strict";t.exports=n.p+"model/numbers.gram"},978:(t,e,n)=>{"use strict";t.exports=n.p+"model/pizza.gram"},859:(t,e,n)=>{"use strict";t.exports=n.p+"518b593640fef65cfcb3.js"},762:()=>{},299:()=>{},395:()=>{}},e={};function n(i){var r=e[i];if(void 0!==r)return r.exports;var s=e[i]={exports:{}};return t[i](s,s.exports,n),s.exports}n.m=t,n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},(()=>{var t;n.g.importScripts&&(t=n.g.location+"");var e=n.g.document;if(!t&&e&&(e.currentScript&&(t=e.currentScript.src),!t)){var i=e.getElementsByTagName("script");i.length&&(t=i[i.length-1].src)}if(!t)throw new Error("Automatic publicPath is not supported in this browser");t=t.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=t})(),n.b=document.baseURI||self.location.href,(()=>{"use strict";n(179),n(985);const t=n(62);var e,i,r,s,o,a,_={Pizza:n(978),Numbers:n(696),Cities:n(348)},l={Cities:n(478)},c=!1;function u(t){document.getElementById("output").innerHTML=t}function f(t){document.getElementById("current-status").innerHTML=t}function p(t){t?(document.getElementById("recording-indicator").innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",document.getElementById("stopBtn").disabled=!1,u("")):(document.getElementById("recording-indicator").innerHTML="",document.getElementById("stopBtn").disabled=!0)}async function d(){c&&(await s.stop(),c=!1),p(!1);try{const t=document.getElementById("jsgf"),e=s.parse_jsgf(t.value);await s.set_fsg(e),e.delete(),f("Updated grammar")}catch(t){throw f("Failed to set grammar: "+t.message),t}}async function h(t){let e=_[t],n=await fetch(e);if(n.ok){let t=await n.text();document.getElementById("jsgf").value=t}else f("Failed to fetch "+e+" :"+n.statusText)}window.onload=async function(){i=await n(890)();const m=document.getElementById("startBtn"),g=document.getElementById("stopBtn"),y=document.getElementById("jsgf");m.disabled=!0,g.disabled=!0;var w=document.getElementById("grammars");for(const t in _){var v=document.createElement("option");v.innerHTML=t,w.appendChild(v)}await h(w.options[w.selectedIndex].innerText);let b=null;y.addEventListener("input",(()=>{clearTimeout(b),b=setTimeout(d,1e3)})),w.addEventListener("change",(async function(){var t=this.options[this.selectedIndex].innerText;await h(t),await d()})),f("Initializing web audio, waiting for approval to access the microphone");try{const t=window.AudioContext||window.webkitAudioContext;e=new t,await e.suspend();const i=await navigator.mediaDevices.getUserMedia({audio:!0});o=e.createMediaStreamSource(i);const r=new URL(n(859),n.b);await e.audioWorklet.addModule(r),a=new AudioWorkletNode(e,"getaudio-processor",{processorOptions:{bufferSize:2048,channel:0}}),o.connect(a),f("Audio recorder ready")}catch(t){return f("Error initializing Web Audio browser: "+t.message),!1}f("Initializing speech recognizer");try{s=new i.Decoder({hmm:"model/en-us",samprate:e.sampleRate}),await s.initialize(),await async function(){for(const t in l){let e=await fetch(l[t]);if(!e.ok)throw new Error("Failed to fetch "+l[t]+" :"+e.statusText);{let t=await e.text(),n=/^(\S+)\s+(.*)$/gm;for(const e of t.trim().matchAll(n)){let n=e.index+e[0].length;if(-1==await s.add_word(e[1],e[2],n==t.length))throw new Error("Failed to add word "+e[1]+" with pronunciation "+e[2])}}}}(),await d()}catch(t){return f("Error initializing speech recognizer: "+t.message),!1}f("Speech recognizer ready"),r=new t({context:e,source:a,voice_start:async()=>{if(!c)try{await s.start(),c=!0}catch(t){throw f("Error starting recognition: "+t.message),t}}}),a.port.onmessage=async function(t){if(!c)return!0;if("ERROR"==t.data)return f("AudioWorkletNode got disconnected somehow?!?!?!"),a=new AudioWorkletNode(e,"getaudio-processor"),o.connect(a).connect(e.destination),!0;try{await s.process(t.data);let e=await s.get_hyp();void 0!==e&&u(e)}catch(t){throw f("Error processing data: "+t.message),t}return!0},m.onclick=async function(){return c&&(await s.stop(),c=!1,r.voice_start()),await e.resume(),p(!0),!0},g.onclick=async function(){if(await e.suspend(),c){try{await s.stop();const t=s.get_hyp();void 0!==t&&u(t),c=!1}catch(t){throw f("Error stopping recognition: "+t.message),t}return p(!1),!0}},m.disabled=!1}})()})();